<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>심부름 서비스 종합 테스트 페이지</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.7/axios.min.js"></script>
    <script>
        const API_BASE_URL = '/errandservice';

        async function makeRequest(method, endpoint, data = null) {
            try {
                const config = {
                    method: method,
                    url: `${API_BASE_URL}${endpoint}`,
                    headers: { 'Content-Type': 'application/json' },
                    data: data ? JSON.stringify(data) : null
                };
                const response = await axios(config);
                return response.data;
            } catch (error) {
                console.error('Error:', error);
                throw error;
            }
        }

        // 카테고리 관련 함수
        async function getAllCategories() {
            const categories = await makeRequest('GET', '/categories');
            displayResult('카테고리 목록', categories);
        }

        async function createCategory() {
            const categoryData = {
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value
            };
            const result = await makeRequest('POST', '/categories', categoryData);
            displayResult('카테고리 생성 결과', result);
        }

        // 심부름 관련 함수
        async function getAllErrands() {
            const errands = await makeRequest('GET', '/errands');
            displayResult('심부름 목록', errands);
        }

        async function createErrand() {
            const errandData = {
                title: document.getElementById('errandTitle').value,
                description: document.getElementById('errandDescription').value,
                categoryId: document.getElementById('errandCategoryId').value,
                location: document.getElementById('errandLocation').value,
                price: document.getElementById('errandPrice').value,
                estimatedTime: document.getElementById('errandEstimatedTime').value,
                deadline: document.getElementById('errandDeadline').value
            };
            const result = await makeRequest('POST', '/errands', errandData);
            displayResult('심부름 생성 결과', result);
        }

        // 서비스 제공 관련 함수
        async function getAllServiceOfferings() {
            const offerings = await makeRequest('GET', '/service-offerings');
            displayResult('서비스 제공 목록', offerings);
        }

        async function createServiceOffering() {
            const offeringData = {
                title: document.getElementById('offeringTitle').value,
                description: document.getElementById('offeringDescription').value,
                categoryId: document.getElementById('offeringCategoryId').value,
                location: document.getElementById('offeringLocation').value,
                priceRange: document.getElementById('offeringPriceRange').value,
                providerId: document.getElementById('offeringProviderId').value
            };
            const result = await makeRequest('POST', '/service-offerings', offeringData);
            displayResult('서비스 제공 생성 결과', result);
        }

        // 리뷰 관련 함수
        async function getReviewsByErrandId() {
            const errandId = document.getElementById('reviewErrandId').value;
            const reviews = await makeRequest('GET', `/reviews/errand/${errandId}`);
            displayResult('심부름 리뷰 목록', reviews);
        }

        async function createReview() {
            const reviewData = {
                errandId: document.getElementById('newReviewErrandId').value,
                reviewerId: document.getElementById('reviewerId').value,
                rating: document.getElementById('reviewRating').value,
                comments: document.getElementById('reviewComments').value
            };
            const result = await makeRequest('POST', '/reviews', reviewData);
            displayResult('리뷰 생성 결과', result);
        }

        function displayResult(title, data) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<h3>${title}</h3><pre>${JSON.stringify(data, null, 2)}</pre>`;
        }
    </script>
</head>
<body>
<h1>심부름 서비스 종합 테스트 페이지</h1>

<h2>카테고리</h2>
<button onclick="getAllCategories()">모든 카테고리 조회</button>
<h3>카테고리 생성</h3>
<input id="categoryName" placeholder="카테고리 이름">
<input id="categoryDescription" placeholder="카테고리 설명">
<button onclick="createCategory()">카테고리 생성</button>

<h2>심부름</h2>
<button onclick="getAllErrands()">모든 심부름 조회</button>
<h3>심부름 생성</h3>
<input id="errandTitle" placeholder="제목">
<input id="errandDescription" placeholder="설명">
<input id="errandCategoryId" placeholder="카테고리 ID">
<input id="errandLocation" placeholder="위치">
<input id="errandPrice" placeholder="가격" type="number">
<input id="errandEstimatedTime" placeholder="예상 시간(분)" type="number">
<input id="errandDeadline" placeholder="마감기한 (YYYY-MM-DD HH:MM)" type="datetime-local">
<button onclick="createErrand()">심부름 생성</button>

<h2>서비스 제공</h2>
<button onclick="getAllServiceOfferings()">모든 서비스 제공 조회</button>
<h3>서비스 제공 생성</h3>
<input id="offeringTitle" placeholder="제목">
<input id="offeringDescription" placeholder="설명">
<input id="offeringCategoryId" placeholder="카테고리 ID">
<input id="offeringLocation" placeholder="위치">
<input id="offeringPriceRange" placeholder="가격 범위">
<input id="offeringProviderId" placeholder="제공자 ID">
<button onclick="createServiceOffering()">서비스 제공 생성</button>

<h2>리뷰</h2>
<input id="reviewErrandId" placeholder="심부름 ID">
<button onclick="getReviewsByErrandId()">심부름 리뷰 조회</button>
<h3>리뷰 생성</h3>
<input id="newReviewErrandId" placeholder="심부름 ID">
<input id="reviewerId" placeholder="리뷰어 ID">
<input id="reviewRating" placeholder="평점" type="number" min="1" max="5">
<input id="reviewComments" placeholder="코멘트">
<button onclick="createReview()">리뷰 생성</button>

<div id="result"></div>
</body>
</html>